<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../css/reset.css" />
    <link rel="stylesheet" type="text/css" href="../../../css/common.css">
    <script type="text/javascript" src="../../../js/jquery-2.1.1.min.js" ></script>
    <script type="text/javascript" src="../../../js/public.js" ></script>
    <script type="text/javascript" src="../../../js/template.js" ></script>
    <script type="text/javascript" src="../../../js/common.js"></script>
    <title>主页</title>
</head>
<style type="text/css">
    .articleTag{
        display: inline-block;
        font-size: 12px;
        margin-right: 30px;
    }
    .articleTag li{
        display: inline-block;
        /*float: right;*/
        padding: 0px 10px;
        cursor: pointer;
        color:#999;
        border-right: 1px solid #ddd;
    }
    .articleTag li:nth-child(4){
        border:0;
    }
    .articleTag li.active{
        color:rgb(88,126,209);
    }
    .dataList .noData{
        text-align: center;
        font-size: 16px;
        padding: 40px 0;
        color: #999;
    }
</style>
<body>
<div class="container">
    <div class="sidebar">
        <div class="title">琴之家</div>
        <ul class="sidenav">
            <li>
                <a href="javascript:;">课程管理</a>
            </li>
            <li>
                <a href="javascript:;">教师管理</a>
            </li>
            <li>
                <a href="javascript:;">学生管理</a>
            </li>
            <li>
                <a href="javascript:;">文章管理</a>
            </li>
            <li>
                <a href="javascript:;">资格审核</a>
            </li>
        </ul>
    </div>
    <div class="wrapper">
        <div class="topCon">
            <button class="fr searchBtn">搜索</button>
            <input class="searchBar fr" />
        </div>
        <div class="mainCon">
            <div class="leftCon">
                <div class="briefInfo">
                    <div class="avatar"><img src="../../../img/avatar/moren.jpg"></div>
                    <div class="info">
                        <div class="name">administer</div>
                        <div class="mobile">140****0001</div>
                        <i class="modify"></i>
                    </div>
                </div>
                <ul class="funcBar">
                    <li><i class="mail">信息</i></li>
                    <li><i class="personalinfo">我的</i></li>
                    <li><i class="rubbish">回收站</i></li>
                </ul>
                <div class="timeCon">
                    <p class="clearfix">
                        <span class="weekdayEn fl">Friday 03 Sep</span>
                        <span class="monthEn fr">April 2015</span>
                    </p>
                    <p class="clearfix">
                        <span class="weekdayCn fl">星期五</span>
                        <span class="monthCn fr">四月</span>
                    </p>
                    <div class="dayBox">
                        <span class="day"><em>03</em>日</span>
                    </div>
                    <button class="record">注销登陆</button>
                </div>
            </div>
            <div class="rightCon">
                <div class="tips" style="margin-top: 20px;">
                    <p class="title">功能介绍</p>
                    <div class="funcIntro">
                        <p>1.此页面可以还原被删除的各项信息。</p>
                        <p>2.还原成功后，会提示“文件已经还原”并刷新列表。</p>
                    </div>
                </div>
                <div class="funcDetail">
                    <div class="title clearfix">
                        <span>回收列表</span>
                        <ul class="articleTag clearfix fr">
                            <li class="active">课程</li>
                            <li>教师</li>
                            <li>学生</li>
                            <li>文章</li>
                        </ul>
                    </div>
                    <ul class="dataList courseList"></ul>
                </div>
         </div>
        </div>
    </div>
    <script id="articleInfo" type="text/html">
        {{if list && list.length>0}}
        <li class="title">
            <div>序号</div>
            <div>标题</div>
            <div>发布时间</div>
            <div>作者</div>
            <div>操作</div>
        </li>
        {{each list as item}}
        <li data-id="{{list.article_id}}">
            <div>{{i+1}}</div>
            <div>{{list.title}}</div>
            <div>{{list.publish_time.split(' ')[0]}}</div>
            <div>{{list.author}}</div>
            <div><a href="javascript:;" class="restore">还原</a></div>
        </li>
        {{/each}}
        {{else}}
        <p class="noData">暂无可还原的文章信息</p>
        {{/if}}
    </script>
    <script id="teacherInfo" type="text/html">
        {{if list && list.length>0}}
        <li class="title">
            <div>序号</div>
            <div>教师姓名</div>
            <div>教师等级</div>
            <div>授课方向</div>
            <div>操作</div>
        </li>
        {{each list as item i}}
        <li data-id="{{item.user_id}}">
            <div>{{i+1}}</div>
            <div>{{item.name}}</div>
            <div>{{item.teacher_rank}}</div>
            <div>{{item.teach_direction}}</div>
            <div><a href="javascript:;" class="restore">还原</a></div>
        </li>
        {{/each}}
        {{else}}
        <p class="noData">暂无可还原的教师信息</p>
        {{/if}}
    </script>
    <script id="studentInfo" type="text/html">
        {{if list && list.length>0}}
        <li class="title">
            <div>序号</div>
            <div>学生姓名</div>
            <div>学生年龄</div>
            <div>学生性别</div>
            <div>操作</div>
        </li>
        {{each list as item i}}
        <li data-id="{{item.user_id}}">
            <div>{{i+1}}</div>
            <div>{{item.name}}</div>
            <div>{{item.age}}</div>
            <div>{{item.sex}}</div>
            <div><a href="javascript:;" class="restore">还原</a></div>
        </li>
        {{/each}}
        {{else}}
        <p class="noData">暂无可还原的学生信息</p>
        {{/if}}
    </script>
    <script id="courseInfo" type="text/html">
        {{if list && list.length>0}}
        <li class="title">
            <div>课程名称</div>
            <div>开始时间</div>
            <div>截止时间</div>
            <div>报名人数</div>
            <div>操作</div>
        </li>
        {{each list as item}}
        <li data-id="{{item.course_id}}">
            <div>{{item.course_name}}</div>
            <div>{{item.start_time.split(' ')[0]}}</div>
            <div>{{item.end_time.split(' ')[0]}}</div>
            <div>{{item.limit_members}}</div>
            <div><a href="javascript:;" class="restore">还原</a></div>
        </li>
        {{/each}}
        {{else}}
        <p class="noData">暂无可还原的课程信息</p>
        {{/if}}
    </script>
</div>
</body>
<script>
    getRubbishList(1);
    $('.articleTag li').click(function(){
        var $this = $(this);
        var index = $this.index();
        if($this.hasClass('active')){
            return;
        }
        $('.articleTag li').removeClass('active');
        $(this).addClass('active');
        if(index==0){
            type=1;
            getRubbishList(type);
            return;
        }
        if(index==1){
            type=2;
			getRubbishList(type);
            return;
        }
        if(index==2){
            type=3;
            getRubbishList(type);
            return;
        }
        if(index==3){
            type=4;
            getRubbishList(type);
        }
    });

    function getRubbishList(type){
        $.ajax({
            url: '/PCAdmin/php/getRubbishList.php',
            type: 'post',
            dataType: 'json',
            data: {
                type: type
            },
            success: function(res){
                if(res.success){
                    var list = res.list;
                    var html;
					if(type==1){
						html = template('courseInfo',{list:list});
					}else if(type==2){
						html = template('teacherInfo',{list:list});
					}else if(type==3){
						html = template('studentInfo',{list:list});
					}else{
						html = template('articleInfo',{list:list});
					}
					$('.dataList').html(html);
                }
                $('.dataList .restore').click(function(){
                    var id = $(this).parent().parent().attr('data-id');
                    $.ajax({
                        url:'/PCAdmin/php/restoreInfo.php',
                        type: 'post',
                        dataType: 'json',
                        data: {
                            id: id,
                            type: type
                        },
                        success: function(data){
                            if(data.success){
                                alert('信息已成功还原，请前往列表页面查看');
                                window.location.reload();
                            }
                        }
                    });
                });
//                $('.dataList .delete').click(function(){
//                    var id = $(this).parent().parent().attr('data-id');
//                    $.ajax({
//                        url:'/PCAdmin/php/deleteArticle.php',
//                        type: 'post',
//                        dataType: 'json',
//                        data: {
//                            id: id
//                        },
//                        success: function(data){
//                            if(data.success){
//                                alert('信息已经成功删除');
//                                window.location.reload();
//                            }
//                        }
//                    });
//                });
            }
        });
    }
</script>
</html>
